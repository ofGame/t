<html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>双爆配平器</title><style>*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-family:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{opacity:1;color:#9ca3af}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]{display:none}*,::after,::before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.\!container{width:100%!important}.container{width:100%}@media (min-width:640px){.\!container{max-width:640px!important}.container{max-width:640px}}@media (min-width:768px){.\!container{max-width:768px!important}.container{max-width:768px}}@media (min-width:1024px){.\!container{max-width:1024px!important}.container{max-width:1024px}}@media (min-width:1280px){.\!container{max-width:1280px!important}.container{max-width:1280px}}@media (min-width:1536px){.\!container{max-width:1536px!important}.container{max-width:1536px}}.card{margin-bottom:2rem;border-radius:.75rem;padding:1.5rem;--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1),0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.dark .card{background-color:rgb(31 41 55 / .8)}.card:hover{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1),0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.section-header{margin-bottom:1rem;font-size:1.25rem;line-height:1.75rem;font-weight:600}.form-control{border-radius:.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity));font-size:.875rem;line-height:1.25rem;--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.dark .form-control{background-color:rgb(31 41 55 / .8);--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.form-label{margin-bottom:.25rem;display:block;font-size:.875rem;line-height:1.25rem;--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity))}.form-input{border-radius:.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity));font-size:.875rem;line-height:1.25rem;--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.dark .form-input{background-color:rgb(31 41 55 / .8);--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.form-input{width:100%;-webkit-appearance:none;-moz-appearance:none;appearance:none;padding-top:.5rem;padding-bottom:.5rem;padding-left:1rem;padding-right:1rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.form-input:focus{--tw-border-opacity:1;border-color:rgb(14 165 233 / var(--tw-border-opacity));--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000);--tw-ring-color:rgb(14 165 233 / 0.5)}.btn-gray-800{border-radius:.5rem;border-width:1px;--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity));font-size:.875rem;line-height:1.25rem;--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.dark .btn-gray-800{background-color:rgb(31 41 55 / .8);--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.btn-gray-800{float:right;padding-top:.25rem;padding-bottom:.25rem;padding-left:.5rem;padding-right:.5rem;font-weight:500;--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity));transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:.5rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.btn-gray-800:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));background-color:rgb(31 41 55 / .8);--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.btn-sky-500{--tw-bg-opacity:1;background-color:rgb(14 165 233 / var(--tw-bg-opacity));padding-top:.5rem;padding-bottom:.5rem;padding-left:1.5rem;padding-right:1.5rem;font-weight:700;--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity));transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:.5rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.btn-sky-500:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:.8}.btn-emerald-500{--tw-bg-opacity:1;background-color:rgb(16 185 129 / var(--tw-bg-opacity));padding-top:.5rem;padding-bottom:.5rem;padding-left:1.5rem;padding-right:1.5rem;font-weight:700;--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity));transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:.5rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.btn-emerald-500:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:.8}.btn-violet-500{--tw-bg-opacity:1;background-color:rgb(139 92 246 / var(--tw-bg-opacity));padding-top:.5rem;padding-bottom:.5rem;padding-left:1.5rem;padding-right:1.5rem;font-weight:700;--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity));transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:.5rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.btn-violet-500:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));opacity:.8}.history-item{cursor:grab;-webkit-user-select:none;-moz-user-select:none;user-select:none;--tw-border-opacity:1;border-color:rgb(229 231 235 / var(--tw-border-opacity));padding:.5rem;--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.dark .history-item{background-color:rgb(31 41 55 / .8)}.history-item{margin-bottom:.5rem;border-radius:.5rem;border-width:2px;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.dark .history-item{--tw-border-opacity:1;border-color:rgb(55 65 81 / var(--tw-border-opacity))}.history-item.dragging{cursor:grabbing;border-style:dashed;--tw-border-opacity:1;border-color:rgb(14 165 233 / var(--tw-border-opacity));background-color:rgb(14 165 233 / .1);opacity:.5}.modal-backdrop{position:fixed;inset:0px;z-index:50;display:flex;align-items:center;justify-content:center;background-color:rgb(0 0 0 / .6);padding:1rem}.modal-content{width:100%;max-width:28rem;border-radius:.75rem;padding:1.5rem;--tw-shadow:0 25px 50px -12px rgb(0 0 0 / 0.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow);--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity))}.dark .modal-content{background-color:rgb(31 41 55 / .8)}.form-checkbox{margin-right:.5rem;height:1rem;width:1rem}.sticky{position:sticky}.top-4{top:1rem}.m-2{margin:.5rem}.mx-auto{margin-left:auto;margin-right:auto}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.ml-6{margin-left:1.5rem}.mt-1{margin-top:.25rem}.mt-8{margin-top:2rem}.flex{display:flex}.grid{display:grid}.hidden{display:none}.max-h-\[62vh\]{max-height:62vh}.min-h-screen{min-height:100vh}.w-1\/3{width:33.333333%}.w-full{width:100%}.max-w-5xl{max-width:64rem}.flex-1{flex:1 1 0%}@keyframes rise{0%{opacity:0;transform:translateY(.5rem)}100%{opacity:1;transform:translateY(0)}}.animate-rise{animation:rise .5s ease-out forwards}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.flex-col{flex-direction:column}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-top:calc(.75rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(.75rem * var(--tw-space-y-reverse))}.overflow-y-auto{overflow-y:auto}.p-2{padding:.5rem}.p-6{padding:1.5rem}.px-4{padding-left:1rem;padding-right:1rem}.py-6{padding-top:1.5rem;padding-bottom:1.5rem}.text-center{text-align:center}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.text-gray-400{--tw-text-opacity:1;color:rgb(156 163 175 / var(--tw-text-opacity))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74 / var(--tw-text-opacity))}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68 / var(--tw-text-opacity))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38 / var(--tw-text-opacity))}.text-sky-500{--tw-text-opacity:1;color:rgb(14 165 233 / var(--tw-text-opacity))}.text-yellow-600{--tw-text-opacity:1;color:rgb(202 138 4 / var(--tw-text-opacity))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.transition{transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:150ms}.will-change-transform{will-change:transform}.bg-base{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity))}.dark .bg-base{background-color:rgb(31 41 55 / .8);--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity))}.btn{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));border-radius:.5rem;transition-property:all;transition-timing-function:cubic-bezier(0.4,0,0.2,1);transition-duration:.3s}.btn:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scrollbar-hide{scrollbar-width:none;-ms-overflow-style:none}.hover\:text-violet-500:hover{--tw-text-opacity:1;color:rgb(139 92 246 / var(--tw-text-opacity))}.hover\:opacity-80:hover{opacity:.8}@media (min-width:768px){.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}}@media (min-width:1024px){.lg\:w-2\/5{width:40%}.lg\:w-3\/5{width:60%}.lg\:flex-row{flex-direction:row}}</style></head><body><div id="app" class="bg-base min-h-screen"><div class="container mx-auto py-6 px-4 max-w-5xl"><div class="flex flex-col justify-center lg:flex-row gap-6"><main class="lg:w-3/5"><section class="card"><div class="mb-2"><h2 class="section-header">基础属性输入 <button id="themeToggle" class="btn-gray-800">主题</button></h2><div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div><div class="mb-4"><label for="EntryW" class="form-label">角色基础攻击（白值）</label> <input type="number" id="EntryW" class="form-input" placeholder="请输入角色基础攻击"></div><div class="mb-4"><label for="EntryG" class="form-label">角色攻击提升值（绿值）</label> <input type="number" id="EntryG" class="form-input" placeholder="请输入角色攻击提升值"></div><div class="mb-4"><label for="ClaimA" class="form-label">伤害模型转换</label> <select id="ClaimA" class="form-input"><option value="1">攻击</option><option value="1">生命</option><option value="1.25">防御</option><option value="400" disabled="disabled">精通</option></select></div></div><div><div class="mb-4"><label for="EntryB" class="form-label">暴击率 %</label> <input type="number" id="EntryB" class="form-input" placeholder="请输入暴击率"></div><div class="mb-4"><label for="EntryC" class="form-label">暴击伤害 %</label> <input type="number" id="EntryC" class="form-input" placeholder="请输入暴击伤害"></div><div class="mb-4"><p class="form-label">测试</p><div class="flex justify-between"><button id="randomBtn" class="btn-emerald-500">随机生成</button> <button id="clearBtn" class="btn-violet-500">清空输入</button></div></div></div></div></div><button id="calculateBtn" class="btn-sky-500 w-full">计算属性分配</button></section><section class="card"><div id="resultsContainer" class="mb-8"><h2 class="section-header">计算结果 <button id="saveBtn" class="btn-gray-800" disabled="disabled">保存</button></h2><div class="bg-base form-control p-6"><ul id="ResultsList" class="space-y-3 transition will-change-transform"></ul></div></div><h2 class="section-header">乘区计算</h2><a href="https://homdgcat.wiki/gi/formulae" class="font-bold text-sky-500 hover:text-violet-500">玉衡杯-公式大全</a></section></main><aside class="lg:w-2/5" id="aside"><section class="card sticky top-4"><h2 class="section-header">保存记录 <button id="removeBtn" class="btn-gray-800">移除</button></h2><div class="mb-3 space-y-3"><div><label for="historySearch" class="form-label">搜索记录</label> <input id="historySearch" class="form-input" placeholder="输入名称搜索..."></div><div class="flex items-center justify-between m-2"><label class="flex items-center text-sm"><input type="checkbox" id="selectAll" class="form-checkbox"> 全选</label><div class="flex gap-4"><button id="reverseHistoryBtn" class="text-sky-500 hover:opacity-80 text-sm">反转顺序</button> <button id="deleteSelectedBtn" class="text-red-500 hover:opacity-80 text-sm" disabled="disabled">删除所选</button></div></div></div><div id="historyList" class="max-h-[62vh] overflow-y-auto scrollbar-hide"><p class="text-gray-500 text-sm p-2">暂无记录</p></div></section></aside></div><footer class="text-center mt-8 text-gray-400 text-sm"><p>contact©原神UID 226115372</p></footer></div><div id="saveModal" class="modal-backdrop hidden"><div class="modal-content"><h3 class="section-header">保存计算结果</h3><div class="mb-8"><label for="saveName" class="form-label">请输入结果名称</label> <input id="saveName" class="form-input" placeholder="例如：爆伤头2+2"></div><div class="flex justify-between"><button id="cancelSaveBtn" class="btn btn-violet-500">取消保存</button> <button id="confirmSaveBtn" class="btn btn-sky-500">确认保存</button></div></div></div></div><script>const Utils={formatTime:e=>new Intl.DateTimeFormat("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).format(e).replace(/\//g,""),calculatePercentage:e=>(100*e).toFixed(1),setFormValues(e){const t=document.createDocumentFragment();Object.entries(e).forEach(([e,n])=>{const s=elements[e];s&&(s.value=n,t.appendChild(s.cloneNode(!0)))}),Object.entries(e).forEach(([e])=>{const n=elements[e];n&&t.querySelector(`#${e}`)&&(n.value=t.querySelector(`#${e}`).value)})}},AppConfig={inputFields:[{id:"EntryW",base:500,labelKey:"基础"},{id:"EntryG",base:1e3,labelKey:"提升值"},{id:"EntryB",base:50},{id:"EntryC",base:100}],constants:{CLAIM_B:.038875,CLAIM_C:.07775,CLAIM_A:.0583125}},Calculator={config:AppConfig,calculate(e){const{EntryW:t,EntryG:n,EntryB:s,EntryC:a}=e,r=parseFloat(elements.claimA.value),l=r*this.config.constants.CLAIM_A,i=elements.claimA.options[elements.claimA.selectedIndex].text,o=n/t/l,c=s/this.config.constants.CLAIM_B/100+a/this.config.constants.CLAIM_C/100+o,d=Math.sqrt(6)/this.config.constants.CLAIM_B-1/l;let m,u,h,g;if(c>7/this.config.constants.CLAIM_C-1/l)m=2/this.config.constants.CLAIM_C,u=(c+1/l-3/this.config.constants.CLAIM_C)/2,h=(c-1/l-1/this.config.constants.CLAIM_C)/2,g={text:"大毕业",class:"text-green-600 font-bold"};else if(c>d){const e=c+1/l;m=(e+Math.sqrt(Math.pow(e,2)-6/Math.pow(this.config.constants.CLAIM_B,2)))/6,u=m,h=c-2*m,g={text:"小毕业",class:"text-yellow-600 font-bold"}}else m=.05/this.config.constants.CLAIM_B,u=.5/this.config.constants.CLAIM_C,h=c-m-u,g={text:"未毕业",class:"text-red-600 font-bold"};const y=l*h,p=this.config.constants.CLAIM_B*m,v=this.config.constants.CLAIM_C*u,f=Math.round((y+1)*t),E=(f*(1+p*v)).toFixed(2);return{params:{EntryW:t,EntryG:n,EntryB:s,EntryC:a,ClaimA:r,selectedText:i},stats:{"综合评分":c.toFixed(2),"加成":Utils.calculatePercentage(y),"总值":f,"暴击率":Utils.calculatePercentage(p),"暴击伤害":Utils.calculatePercentage(v),"总期望":E,"评价":g.text,"评价Class":g.class}}}},elements=(()=>{const e={list:document.getElementById("ResultsList"),claimA:document.getElementById("ClaimA"),randomBtn:document.getElementById("randomBtn"),clearBtn:document.getElementById("clearBtn"),calculateBtn:document.getElementById("calculateBtn"),saveBtn:document.getElementById("saveBtn"),themeToggle:document.getElementById("themeToggle"),body:document.body,historyList:document.getElementById("historyList"),historySearch:document.getElementById("historySearch"),selectAll:document.getElementById("selectAll"),deleteSelectedBtn:document.getElementById("deleteSelectedBtn"),reverseHistoryBtn:document.getElementById("reverseHistoryBtn"),saveModal:document.getElementById("saveModal"),saveName:document.getElementById("saveName"),cancelSaveBtn:document.getElementById("cancelSaveBtn"),confirmSaveBtn:document.getElementById("confirmSaveBtn")};return AppConfig.inputFields.reduce((e,t)=>(e[t.id]=document.getElementById(t.id),t.labelKey&&(e[`label${t.id}`]=document.querySelector(`label[for="${t.id}"]`)),e),e)})(),AppState={currentCalculation:null,currentSearchTerm:"",draggedItem:null,dragOverItem:null,renderedOrder:[]},HistoryManager={getHistory(){try{const e=localStorage.getItem("calculationHistory");return e&&Array.isArray(JSON.parse(e))?JSON.parse(e):[]}catch(e){return console.error("获取记录失败:",e),localStorage.removeItem("calculationHistory"),[]}},saveHistory(e,t){if(!e)return!1;try{const n=this.getHistory(),s={...e,timestamp:(new Date).toISOString(),name:t||`计算记录-${Utils.formatTime(new Date)}`};return n.unshift(s),localStorage.setItem("calculationHistory",JSON.stringify(n)),this.renderHistory(),!0}catch(e){return console.error("保存记录失败:",e),alert("保存失败，请重试"),!1}},reorderHistory(e){try{if(Array.isArray(e))return localStorage.setItem("calculationHistory",JSON.stringify(e)),!0}catch(e){console.error("排序记录失败:",e)}return!1},reverseHistory(){try{let e=this.getHistory();return!(e.length<=1)&&(e.reverse(),this.reorderHistory(e),this.renderHistory(),!0)}catch(e){console.error("反转记录失败:",e)}return!1},deleteHistory(e){try{const t=this.getHistory();if(Number.isInteger(e)&&e>=0&&e<t.length)return t.splice(e,1),localStorage.setItem("calculationHistory",JSON.stringify(t)),this.renderHistory(),!0}catch(e){console.error("删除记录失败:",e)}return!1},deleteSelected(){const e=document.querySelectorAll(".history-checkbox:checked");if(0===e.length)return!1;try{let t=this.getHistory();return Array.from(e).map(e=>parseInt(e.dataset.index,10)).filter(e=>!isNaN(e)).sort((e,t)=>t-e).forEach(e=>t.splice(e,1)),localStorage.setItem("calculationHistory",JSON.stringify(t)),this.renderHistory(),!0}catch(e){console.error("删除选中记录失败:",e)}return!1},updateSelectAllStatus(){const e=document.querySelectorAll(".history-checkbox"),t=document.querySelectorAll(".history-checkbox:checked"),n=e.length>0;elements.selectAll.checked=n&&e.length===t.length,elements.deleteSelectedBtn.disabled=0===t.length},filterHistory(e,t){if(!t)return e;const n=t.toLowerCase();return e.filter(e=>e.name?.toLowerCase().includes(n)||e.stats?.综合评分?.includes(n)||e.stats?.评价?.toLowerCase().includes(n))},getDragAfterElement:(e,t)=>[...e.querySelectorAll(".history-item:not(.dragging)")].reduce((e,n)=>{const s=n.getBoundingClientRect(),a=t-s.top-s.height/2;return a<0&&a>e.offset?{offset:a,element:n}:e},{offset:Number.NEGATIVE_INFINITY}).element,saveDraggedOrder(e){const t=e.querySelectorAll(".history-item"),n=this.getHistory(),s=[];t.forEach(e=>{const t=e.dataset.timestamp,a=n.find(e=>e.timestamp===t);a&&s.push(a)}),this.reorderHistory(s),this.renderHistory()},fillFormFromHistory(e){if(!e?.params)return;const{EntryW:t,EntryG:n,EntryB:s,EntryC:a,ClaimA:r}=e.params;Utils.setFormValues({EntryW:t,EntryG:n,EntryB:s,EntryC:a}),elements.claimA.value=r,elements.claimA.dispatchEvent(new Event("change")),calculateStats()},initDragAndDrop(e){e&&(e.addEventListener("dragover",t=>{t.preventDefault();const n=document.querySelector(".history-item.dragging");if(!n)return;const s=this.getDragAfterElement(e,t.clientY);s?e.insertBefore(n,s):e.appendChild(n)}),e.addEventListener("drop",t=>{t.preventDefault(),this.saveDraggedOrder(e)}),e.addEventListener("click",e=>{if(e.target.classList.contains("delete-item")){const t=parseInt(e.target.dataset.index,10);confirm("确定要删除这条记录吗？")&&this.deleteHistory(t)}}),e.addEventListener("change",e=>{e.target.classList.contains("history-checkbox")&&this.updateSelectAllStatus()}))},renderHistory(){try{const e=this.getHistory(),t=this.filterHistory(e,AppState.currentSearchTerm),n=elements.historyList;if(AppState.renderedOrder=t.map(e=>e.timestamp),0===t.length)return n.innerHTML=`<p class="text-gray-500 text-sm p-2">${AppState.currentSearchTerm?"没有匹配的":"暂无"}记录</p>`,void this.updateSelectAllStatus();const s=document.createDocumentFragment(),a=document.createElement("div");a.id="sortable-history",s.appendChild(a);const r=!AppState.currentSearchTerm;r&&a.setAttribute("data-draggable","true"),t.forEach(t=>{const n=e.findIndex(e=>e.timestamp===t.timestamp);if(-1===n)return;const s=new Date(t.timestamp),l=Utils.formatTime(s),i=document.createElement("div");i.className="history-item",i.draggable=r,i.dataset.timestamp=t.timestamp,i.addEventListener("click",e=>{e.target.closest(".delete-item, .history-checkbox")||this.fillFormFromHistory(t)}),r&&(i.addEventListener("dragstart",()=>{i.classList.add("dragging")}),i.addEventListener("dragend",()=>{i.classList.remove("dragging")})),i.innerHTML=`<label class="flex items-center"><input type="checkbox" class="history-checkbox form-checkbox" data-index="${n}"><span class="font-medium text-sm">${t.name}</span></label><div class="flex justify-between"><div class="text-xs ml-6"><div class="text-gray-500 mt-1">${l}</div><p><span class="${t.stats?.评价Class}">${t.stats?.评价}</span> 综合评分: ${t.stats?.综合评分}</p><p>${t.params?.selectedText}总值: ${t.stats?.总值}</p><p>暴击爆伤:${t.stats?.暴击率}/${t.stats?.暴击伤害}</p></div><button class="delete-item text-red-500 hover:opacity-80 text-xs" data-index="${n}">删除</button></div>`,a.appendChild(i)}),n.innerHTML="",n.appendChild(s),this.initDragAndDrop(a),this.updateSelectAllStatus()}catch(e){console.error("渲染记录失败:",e)}}};function handleAnimationEnd(){elements.list.classList.remove("animate-rise"),elements.list.removeEventListener("animationend",handleAnimationEnd)}function updateResultsList(e){if(!e||!Array.isArray(e))return;elements.list.innerHTML="";const t=document.createDocumentFragment();e.forEach(e=>{const n=document.createElement("li");n.className=`flex ${e.customClass||""}`;const s=document.createElement("span");s.className="w-1/3",s.textContent=e.label;const a=document.createElement("span");a.className="flex-1",a.textContent=e.value,n.append(s,a),t.appendChild(n)}),elements.list.appendChild(t),elements.list.classList.remove("animate-rise"),requestAnimationFrame(()=>{elements.list.addEventListener("animationend",handleAnimationEnd),elements.list.classList.add("animate-rise")})}function getInputValues(){return AppConfig.inputFields.reduce((e,t)=>{const n=parseFloat(elements[t.id].value)||0;return e[t.id]=Math.max(0,n),e},{})}function calculateStats(){const e=getInputValues();AppState.currentCalculation=Calculator.calculate(e);const{stats:t,params:n}=AppState.currentCalculation;updateResultsList([{label:"综合评分:",value:t.综合评分},{label:`${n.selectedText}加成:`,value:`${t.加成}%`},{label:`总${n.selectedText}:`,value:t.总值},{label:"暴击率:",value:`${t.暴击率}%`},{label:"暴击伤害:",value:`${t.暴击伤害}%`},{label:"总期望:",value:t.总期望},{label:"评价:",value:t.评价,customClass:t.评价Class}]),elements.saveBtn.disabled=!1}function generateRandomNumbers(){AppConfig.inputFields.forEach(e=>{elements[e.id].value=Math.ceil((Math.random()+1)*e.base)}),calculateStats()}function clearInputValues(){const e=AppConfig.inputFields.reduce((e,t)=>(e[t.id]="",e),{});Utils.setFormValues(e),elements.list.innerHTML="",elements.saveBtn.disabled=!0,AppState.currentCalculation=null,window.scrollTo({top:0,behavior:"smooth"})}function showSaveModal(){if(!AppState.currentCalculation)return void alert("没有可保存的计算结果");const e=`${elements.claimA.options[elements.claimA.selectedIndex].text}${AppState.currentCalculation.stats.评价} ${Utils.formatTime(new Date)}`;elements.saveName.value=e,elements.saveModal.classList.remove("hidden"),elements.saveName.focus()}function hideSaveModal(){elements.saveModal.classList.add("hidden"),elements.saveName.value=""}function saveCurrentResult(){if(!AppState.currentCalculation)return;const e=elements.saveName.value.trim();if(!e)return alert("请输入结果名称"),void elements.saveName.focus();HistoryManager.saveHistory(AppState.currentCalculation,e)&&hideSaveModal()}function initEventListeners(){const e=localStorage.getItem("theme");("dark"===e||!e&&window.matchMedia("(prefers-color-scheme: dark)").matches)&&elements.body.classList.add("dark"),elements.themeToggle.addEventListener("click",()=>{elements.body.classList.toggle("dark"),localStorage.setItem("theme",elements.body.classList.contains("dark")?"dark":"light")}),HistoryManager.renderHistory(),elements.randomBtn.addEventListener("click",generateRandomNumbers),elements.clearBtn.addEventListener("click",clearInputValues),elements.calculateBtn.addEventListener("click",()=>{calculateStats(),window.scrollTo({top:window.innerHeight,behavior:"smooth"})}),elements.saveBtn.addEventListener("click",showSaveModal),elements.historySearch.addEventListener("input",e=>{AppState.currentSearchTerm=e.target.value.trim(),HistoryManager.renderHistory()}),elements.reverseHistoryBtn.addEventListener("click",()=>{HistoryManager.reverseHistory()}),elements.selectAll.addEventListener("change",e=>{document.querySelectorAll(".history-checkbox").forEach(t=>{t.checked=e.target.checked}),HistoryManager.updateSelectAllStatus()}),elements.deleteSelectedBtn.addEventListener("click",()=>{confirm("确定要删除选中的记录吗？")&&HistoryManager.deleteSelected()}),elements.cancelSaveBtn.addEventListener("click",hideSaveModal),elements.confirmSaveBtn.addEventListener("click",saveCurrentResult),elements.saveModal.addEventListener("click",e=>{e.target===elements.saveModal&&hideSaveModal()}),document.addEventListener("keydown",e=>{"Escape"!==e.key||elements.saveModal.classList.contains("hidden")||hideSaveModal()}),elements.saveName.addEventListener("keydown",e=>{"Enter"===e.key&&saveCurrentResult()}),elements.claimA.addEventListener("change",function(){const e=this.options[this.selectedIndex].text;AppConfig.inputFields.filter(e=>e.labelKey).forEach(t=>{const n=elements[`label${t.id}`];n&&(n.textContent=`角色${t.labelKey}${e}${"EntryW"===t.id?"（白值）":"（绿值）"}`);const s=elements[t.id];s&&(s.placeholder=`请输入角色${t.labelKey}${e}`)})}),elements.claimA.dispatchEvent(new Event("change"))}document.getElementById("removeBtn")?.addEventListener("click",()=>document.getElementById("aside")?.remove(),{once:!0}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",initEventListeners):initEventListeners()</script></body></html>